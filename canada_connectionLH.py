#! /usr/bin/env python3 
# Pull Canadian stations for BC and Yukon
import urllib.request
import shutil
import requests
import numpy as np
import pandas as pd

def download_canada_data(year, month):
    # 

  canadian_temp_normals = {
    "BEAVER CREEK A": [ "-25.2", "-19.9", "-12.3", "-1.3", "6.6", "12.4", "14.1", "11.3", "4.6", "-6.2", "-19.0", "-23.6" ],
    "BLANCHARD RIVER": [ "-14.6", "-11.0", "-8.3", "-2.5", "4.2", "9.1", "10.9", "9.9", "5.4", "-1.2", "-9.6", "-11.0" ],
    "BRAEBURN": [ "-20.7", "-18.4", "-9.4", "0.3", "6.9", "11.3", "13.8", "11.3", "5.8", "-2.3", "-16.0", "-19.9" ],
    "BURWASH A": [ "-20.5", "-16.4", "-10.8", "-1.2", "5.7", "11.1", "13.1", "10.9", "5.1", "-3.4", "-14.6", "-17.8" ],
    "CARCROSS": [ "-18.2", "-13.9", "-7.8", "-0.7", "0.0", "0.0", "14.2", "13.0", "7.9", "1.1", "-7.7", "-11.6" ],
    "DAWSON A": [ "-26.0", "-21.5", "-12.1", "-0.1", "8.2", "14.0", "15.7", "12.3", "5.8", "-4.7", "-18.1", "-22.9" ],
    "DRURY CREEK": [ "-21.1", "-12.9", "-9.2", "1.7", "", "", "14.0", "13.0", "7.8", "-1.3", "-15.3", "-16.3" ],
    "FARO (AUT)": [ "-20.1", "-15.5", "-8.6", "0.6", "7.5", "13.2", "15.0", "12.4", "6.4", "-2.0", "-14.8", "-17.9" ],
    "HAINES JUNCTION": [ "-20.6", "-15.0", "-7.8", "0.9", "", "", "12.5", "10.6", "7.2", "-1.0", "-13.2", "-15.9" ],
    "HOUR LAKE": [ "-19.9", "-16.3", "-10.3", "-1.3", "5.5", "11.9", "13.5", "11.4", "5.8", "-1.9", "-14.9", "-17.8" ],
    "JOHNSONS CROSSING": [ "-16.2", "-14.6", "-6.2", "0.4", "6.4", "11.2", "13.6", "11.4", "6.4", "0.0", "-10.5", "-14.8" ],
    "KLONDIKE": [ "-21.7", "-17.1", "-14.3", "-5.0", "3.7", "10.5", "11.7", "8.4", "3.3", "-5.9", "-15.3", "-17.4" ],
    "MAYO A": [ "-23.1", "-17.9", "-9.6", "1.0", "8.8", "14.5", "16.1", "13.1", "6.4", "-2.7", "-15.3", "-19.9" ],
    "MAYO ROAD": [ "-17.2", "-13.0", "-7.5", "1.4", "7.7", "12.9", "14.9", "12.8", "7.1", "-0.1", "-11.2", "-14.4" ],
    "MCQUESTEN": [ "-25.0", "-18.8", "-10.8", "0.9", "8.3", "13.7", "15.3", "12.2", "5.7", "-3.3", "-16.9", "-20.8" ],
    "OGILVIE RIVER": [ "-27.0", "-27.1", "-21.1", "-8.8", "3.1", "11.8", "13.1", "10.0", "3.4", "-9.8", "-23.6", "-27.3" ],
    "OLD CROW": [ "-29.2", "-26.5", "-21.2", "-10.1", "2.7", "12.9", "14.6", "10.9", "3.5", "-8.8", "-22.9", "-25.1" ],
    "OTTER FALLS NCPC": [ "-16.1", "-12.2", "-7.7", "-0.7", "5.9", "10.9", "13.0", "10.8", "5.8", "-1.5", "-11.7", "-13.7" ],
    "PELLY RANCH": [ "-24.9", "-19.5", "-10.6", "0.7", "8.3", "13.9", "15.8", "12.8", "6.5", "-2.5", "-16.3", "-21.9" ],
    "PORTER CREEK WAHL": [ "-17.4", "-11.6", "-6.9", "1.9", "7.5", "12.8", "14.5", "12.6", "7.1", "-0.2", "-9.7", "-12.7" ],
    "STEWART CROSSING": [ "-27.8", "-19.9", "-10.9", "1.5", "", "14.6", "", "13.4", "7.0", "-5.0", "-21.3", "-19.2" ],
    "TAKHINI RIVER RANCH": [ "-18.2", "-14.0", "-7.9", "0.3", "6.9", "11.9", "13.9", "11.7", "6.6", "-1.0", "-11.8", "-14.5" ],
    "TESLIN (AUT)": [ "-17.1", "-13.6", "-6.5", "0.7", "6.9", "11.9", "14.1", "12.2", "7.3", "0.4", "-10.2", "-13.4" ],
    "WATSON LAKE (AUT)": [ "-22.5", "-17.0", "-9.6", "0.1", "7.6", "13.2", "15.3", "13.0", "7.5", "-0.5", "-14.7", "-20.8" ],
    "WHITEHORSE A": [ "-15.2", "-12.7", "-6.3", "1.0", "7.3", "12.3", "14.3", "12.6", "7.2", "0.5", "-9.4", "-12.5" ],
    "WHITEHORSE RIVERDALE": [ "-16.2", "-11.8", "-6.0", "1.8", "8.0", "13.1", "15.1", "13.1", "7.5", "0.5", "-9.8", "-13.2" ],
    "ADDENBROKE ISLAND": [ "4.7", "4.9", "6.1", "8.0", "10.6", "13.0", "14.9", "15.2", "13.0", "9.6", "6.2", "4.7" ],
    "ATLIN": [ "-12.8", "-10.7", "-5.5", "1.3", "6.9", "11.3", "13.4", "12.4", "8.1", "2.6", "-5.5", "-8.1" ],
    "BOAT BLUFF": [ "3.6", "3.9", "5.3", "7.4", "10.4", "12.9", "14.7", "15.1", "12.8", "9.0", "5.2", "3.6" ],
    "BOB QUINN AGS": [ "-7.1", "-6.0", "0.0", "4.0", "8.5", "12.0", "14.3", "13.4", "9.4", "3.8", "-3.9", "-7.9" ],
    "BONILLA ISLAND": [ "5.0", "5.0", "5.8", "7.5", "9.5", "11.8", "13.4", "14.0", "12.7", "9.9", "6.6", "5.3" ],
    "CAPE SCOTT": [ "5.7", "5.6", "6.2", "7.6", "9.6", "11.7", "13.4", "14.1", "12.7", "10.0", "7.3", "5.6" ],
    "CAPE ST JAMES": [ "5.7", "5.4", "6.3", "7.2", "9.1", "11.2", "13.2", "14.4", "13.6", "10.2", "6.9", "5.7" ],
    "CEDARVALE": [ "-3.6", "-2.7", "2.6", "6.7", "11.0", "14.5", "17.2", "16.7", "12.2", "6.1", "-0.4", "-4.8" ],
    "COAL HARBOUR RUPERT IN": [ "3.8", "4.3", "6.1", "7.8", "10.9", "13.1", "15.4", "15.7", "13.6", "9.4", "5.3", "3.2" ],
    "DEASE LAKE A": [ "-16.1", "-11.9", "-5.7", "1.3", "6.7", "11.1", "13.0", "11.7", "7.2", "0.8", "-9.3", "-14.5" ],
    "DEASE LAKE (AUT)": [ "-17.5", "-12.3", "-6.6", "1.2", "6.8", "11.7", "13.0", "12.0", "7.3", "1.2", "-8.9", "-13.3" ],
    "DRYAD POINT": [ "4.2", "4.7", "6.0", "8.1", "11.0", "13.5", "15.4", "15.9", "13.6", "9.8", "6.1", "4.4" ],
    "EGG ISLAND": [ "4.9", "5.1", "6.2", "7.7", "10.0", "12.1", "13.7", "13.9", "12.1", "9.3", "6.3", "4.7" ],
    "FRASER CAMP": [ "-12.8", "-10.8", "-7.6", "-1.7", "4.6", "8.8", "10.8", "9.9", "5.7", "0.2", "-6.4", "-9.3" ],
    "GRAHAM INLET": [ "-15.5", "-14.6", "-7.3", "0.3", "6.2", "10.9", "13.0", "11.6", "6.7", "0.7", "-6.9", "-12.8" ],
    "GREEN ISLAND": [ "3.2", "3.8", "5.1", "7.4", "10.2", "12.9", "14.6", "14.8", "12.4", "8.9", "5.3", "3.9" ],
    "HARTLEY BAY": [ "1.5", "2.5", "4.7", "6.7", "10.6", "13.3", "15.5", "15.4", "13.1", "8.4", "3.9", "1.9" ],
    "HAZELTON TEMLEHAN": [ "-8.1", "-4.3", "1.2", "6.2", "10.8", "14.0", "16.4", "15.9", "11.5", "5.4", "-2.0", "-7.3" ],
    "ISKUT RANCH": [ "-10.5", "-8.9", "-3.7", "1.1", "6.5", "10.0", "12.0", "11.2", "7.1", "1.4", "-6.7", "-11.1" ],
    "IVORY ISLAND": [ "4.3", "4.9", "5.8", "8.0", "10.3", "12.6", "14.3", "14.9", "13.2", "9.8", "6.5", "4.9" ],
    "KEMANO": [ "-1.5", "0.4", "3.3", "7.2", "11.1", "14.4", "16.5", "16.4", "12.7", "7.2", "1.9", "-0.8" ],
    "KILDALA": [ "-1.5", "0.1", "3.4", "6.7", "10.6", "13.6", "16.0", "16.0", "12.4", "7.1", "2.0", "-0.8" ],
    "KITIMAT": [ "-1.0", "-0.2", "4.0", "7.0", "11.0", "14.0", "16.6", "16.3", "12.6", "7.6", "2.2", "-1.0" ],
    "KITIMAT 2": [ "-0.9", "0.9", "3.8", "7.3", "11.2", "14.9", "17.1", "17.1", "13.2", "7.9", "2.4", "-0.2" ],
    "KITIMAT HATCHERY": [ "-2.1", "0.8", "2.7", "7.0", "10.8", "14.3", "16.3", "16.3", "12.6", "7.4", "1.9", "-0.6" ],
    "KITIMAT TOWNSITE": [ "-1.7", "0.3", "3.2", "7.1", "11.0", "14.5", "16.7", "16.5", "12.6", "7.2", "1.8", "-0.8" ],
    "LANGARA": [ "4.0", "4.1", "4.8", "6.3", "8.5", "10.8", "12.7", "13.6", "12.3", "9.2", "5.6", "4.3" ],
    "MCINNES ISLAND": [ "4.7", "5.1", "6.2", "7.9", "10.3", "12.5", "14.2", "14.7", "13.1", "9.9", "6.5", "5.0" ],
    "MORESBY ISLAND MITCHELL INLET": [ "3.9", "4.2", "4.7", "6.8", "9.4", "12.1", "13.9", "14.5", "12.6", "9.1", "6.0", "4.7" ],
    "NASS CAMP": [ "-5.6", "-2.3", "1.7", "5.9", "10.4", "13.9", "15.8", "15.3", "11.3", "5.6", "-0.8", "-3.9" ],
    "PALLANT CREEK": [ "2.8", "3.4", "4.6", "6.3", "9.5", "12.1", "14.4", "15.0", "12.8", "8.7", "4.6", "2.8" ],
    "PINE ISLAND": [ "5.5", "5.9", "6.7", "8.3", "10.3", "11.9", "13.0", "13.3", "12.1", "9.8", "7.2", "5.7" ],
    "PLEASANT CAMP": [ "-7.9", "-5.4", "-2.3", "2.7", "7.8", "12.3", "14.5", "13.3", "8.7", "2.8", "-4.6", "-6.4" ],
    "PORT ALICE": [ "4.9", "5.1", "6.4", "8.3", "11.3", "13.8", "16.1", "16.4", "14.1", "10.2", "6.6", "4.6" ],
    "PORT HARDY A": [ "4.2", "4.4", "5.5", "7.3", "10.1", "12.3", "14.3", "14.4", "12.2", "8.8", "5.5", "3.7" ],
    "PRINCE RUPERT": [ "2.4", "2.7", "4.2", "6.4", "9.0", "11.6", "13.4", "13.8", "11.5", "8.0", "4.3", "2.7" ],
    "QUATSINO": [ "4.4", "4.9", "6.4", "8.3", "10.9", "13.3", "15.3", "15.8", "13.8", "9.8", "6.0", "4.0" ],
    "QUATSINO LIGHTSTATION": [ "6.0", "6.2", "6.9", "8.3", "10.7", "12.8", "14.8", "15.6", "14.1", "10.7", "7.5", "5.8" ],
    "ROSSWOOD": [ "-3.4", "-1.4", "2.9", "6.4", "10.6", "13.9", "16.2", "15.9", "11.6", "6.2", "0.3", "-3.3" ],
    "SANDSPIT A": [ "4.0", "4.1", "4.9", "6.6", "9.4", "12.2", "14.5", "15.2", "13.2", "9.4", "5.7", "4.2" ],
    "SEWALL MASSET INLET": [ "3.6", "3.6", "4.7", "6.4", "9.3", "12.4", "14.6", "15.0", "12.6", "8.7", "4.7", "3.5" ],
    "SMITHERS A": [ "-7.2", "-4.4", "0.1", "4.8", "9.4", "13.0", "15.2", "14.6", "9.9", "4.4", "-2.1", "-7.1" ],
    "STEWART A": [ "-3.0", "-1.1", "1.9", "6.1", "10.7", "13.9", "15.1", "14.3", "11.1", "6.3", "0.6", "-2.1" ],
    "SUSKWA VALLEY": [ "-6.4", "-3.5", "0.4", "4.9", "9.0", "12.6", "14.5", "13.9", "9.6", "4.1", "-2.5", "-5.1" ],
    "TAHTSA LAKE WEST": [ "-5.5", "-4.7", "-1.5", "1.7", "5.2", "8.6", "11.8", "11.8", "8.4", "3.2", "-2.2", "-4.8" ],
    "TELEGRAPH CREEK": [ "-12.9", "-8.9", "-1.1", "4.8", "9.7", "14.1", "16.0", "14.9", "9.9", "3.2", "-6.9", "-11.2" ],
    "TERRACE A": [ "-3.0", "-0.9", "2.4", "6.3", "10.6", "14.2", "16.5", "16.3", "12.1", "6.4", "0.7", "-2.6" ],
    "TERRACE PCC": [ "-2.0", "0.2", "3.5", "7.3", "11.3", "14.6", "16.8", "16.8", "12.6", "7.2", "1.8", "-1.3" ],
    "TLELL": [ "3.1", "3.4", "4.6", "6.4", "9.4", "11.8", "14.2", "14.7", "12.5", "8.6", "4.7", "3.1" ],
    "TODAGIN RANCH": [ "-11.8", "-9.2", "-4.3", "0.4", "5.6", "9.6", "11.7", "10.9", "6.8", "0.9", "-8.8", "-12.5" ],
    "TRIPLE ISLAND": [ "4.0", "4.8", "5.2", "7.3", "9.4", "11.6", "13.3", "13.9", "12.4", "9.4", "6.3", "5.0" ],
    "UNUK RIVER ESKAY CREEK": [ "-8.2", "-5.9", "-4.1", "0.5", "4.2", "8.2", "10.2", "10.4", "5.7", "0.7", "-4.8", "-6.6" ]
  }

  canadian_precip_normals = {
    "BEAVER CREEK A": [ "13.85", "13.94", "12.9", "8.84", "39.69", "72", "101.25", "57.08", "36.89", "28.08", "19.21", "13.53" ],
    "BLANCHARD RIVER": [ "45.15", "39", "27.59", "19.32", "18.07", "38.36", "50.87", "47.36", "69.21", "60.69", "63.47", "73.53" ],
    "BRAEBURN": [ "15.28", "15.13", "6.85", "5.33", "23.28", "38.83", "62.94", "33.35", "31.29", "22.12", "19.88", "17.15" ],
    "BURWASH A": [ "8.38", "7.32", "6.9", "6.8", "24.12", "49.2", "67.91", "41.77", "25.24", "16.1", "10.76", "10.23" ],
    "CARCROSS": [ "28.64", "23.39", "9.58", "5.49", "14.91", "28.46", "29.91", "28.11", "32.89", "27", "28.86", "22.53" ],
    "DAWSON A": [ "19.36", "12.81", "9.86", "8.18", "30.77", "38.17", "49.04", "43.43", "33.97", "31.36", "25.5", "21.95" ],
    "DRURY CREEK": [ "25.83", "22.35", "16.86", "9.7", "28.85", "34.28", "58.54", "51.09", "48.59", "31.51", "25.08", "24.05" ],
    "FARO (AUT)": [ "14.58", "12.3", "12.3", "8.7", "27.92", "36.67", "56.13", "48.18", "41", "27.3", "19.36", "15.24" ],
    "HAINES JUNCTION": [ "33.82", "24.45", "12.5", "7.85", "17.99", "35.28", "45.49", "37.66", "35", "26.7", "36.33", "40.13" ],
    "HOUR LAKE": [ "37.34", "28.45", "26.13", "16.15", "42.79", "59.1", "68.13", "63.31", "55.57", "47.79", "43.64", "45.19" ],
    "JOHNSONS CROSSING": [ "29.93", "20.01", "13.57", "8.77", "22.77", "40.43", "56.2", "45.03", "51.99", "39.09", "34.79", "28.42" ],
    "KLONDIKE": [ "30.48", "22.74", "26.1", "18.44", "23.62", "54.9", "76.54", "71.56", "51.55", "36.82", "32.93", "39.93" ],
    "MAYO A": [ "18.32", "12.95", "9.89", "8.78", "23.18", "39.03", "50.15", "44.62", "38.68", "27.04", "21.12", "19.78" ],
    "MAYO ROAD": [ "21.65", "13.8", "11.76", "5.17", "25.31", "39.01", "50.95", "47.87", "35.92", "23.31", "18.93", "19.68" ],
    "MCQUESTEN": [ "23.22", "14.26", "12.8", "9.5", "30.4", "35", "54.27", "39.83", "39.58", "27.42", "30.22", "27.56" ],
    "OGILVIE RIVER": [ "16.4", "14.44", "11.6", "8.35", "23.94", "51.11", "62.67", "48.96", "36.33", "31.11", "18.88", "22.52" ],
    "OLD CROW": [ "13.12", "13.78", "14.37", "9.5", "14.43", "37.2", "43.52", "46.72", "29.04", "22.09", "18.11", "16.68" ],
    "OTTER FALLS NCPC": [ "16.2", "13.19", "12.23", "8.52", "20.98", "43.69", "54.5", "43.06", "31.04", "23.5", "16.98", "14.66" ],
    "PELLY RANCH": [ "19.71", "14.9", "10.62", "8.87", "27.17", "38.52", "57.98", "41.43", "31.63", "24.48", "25.82", "19.38" ],
    "PORTER CREEK WAHL": [ "24.61", "15.01", "16.6", "7.47", "19.11", "35.67", "43.22", "38.76", "32.56", "26.14", "25.91", "25.34" ],
    "STEWART CROSSING": [ "23.25", "13.7", "10.4", "8.28", "27.63", "39.37", "54.15", "46.02", "35.67", "24.25", "28.1", "25.66" ],
    "TAKHINI RIVER RANCH": [ "14.75", "7.9", "7.57", "3.14", "15.19", "30.57", "39.63", "37.3", "26.82", "17.7", "14.68", "12.33" ],
    "TESLIN (AUT)": [ "26.54", "16.14", "14.16", "9.37", "24.01", "30.74", "44.22", "41.39", "48.71", "38.48", "27.35", "25.21" ],
    "WATSON LAKE (AUT)": [ "30.88", "20.44", "15.26", "14.14", "37.44", "54.94", "59.5", "47.63", "42.6", "37.71", "27.93", "27.9" ],
    "WHITEHORSE A": [ "17.83", "11.81", "10.31", "6.97", "16.26", "32.41", "38.12", "35.78", "33.28", "23.17", "20.08", "16.3" ],
    "WHITEHORSE RIVERDALE": [ "19.22", "13.59", "11.72", "6.79", "16.29", "33.38", "39.62", "36.52", "35.31", "26.14", "22.7", "20.31" ],
    "ADDENBROKE ISLAND": [ "405.73", "266.11", "263.16", "236.12", "162.35", "158.03", "108.65", "138.22", "228.08", "431.95", "496.38", "367.44" ],
    "ATLIN": [ "45.63", "25.43", "17.43", "9.38", "18.22", "29.7", "32.81", "34.2", "41.96", "37.37", "36.13", "36.44" ],
    "BOAT BLUFF": [ "601.94", "428.53", "428.43", "389.14", "257.7", "226.21", "179.81", "231.36", "365.97", "631.8", "677.75", "628.12" ],
    "BOB QUINN AGS": [ "67.54", "42.49", "29.18", "26.46", "29.95", "37.62", "58.26", "51.78", "87.58", "89.09", "58.95", "56.49" ],
    "BONILLA ISLAND": [ "237.71", "176.8", "186.75", "164.19", "121.95", "98.38", "87.8", "112.57", "165.78", "252.13", "264.18", "271.57" ],
    "CAPE SCOTT": [ "324.74", "238.57", "239.96", "201.59", "125.66", "117.29", "80.15", "110.15", "147.59", "317.71", "371.4", "329.42" ],
    "CAPE ST JAMES": [ "190.97", "125.77", "124.85", "109.3", "88.74", "83.29", "60.88", "77.08", "95.96", "180.82", "199.65", "173.82" ],
    "CEDARVALE": [ "118.6", "59.11", "42.43", "38.5", "42.27", "54.63", "37.31", "47.6", "85.06", "126.96", "100.69", "110.16" ],
    "COAL HARBOUR RUPERT IN": [ "297.37", "193.22", "152.66", "138.81", "77.57", "78.33", "42.9", "62.62", "94.47", "270.44", "343.57", "259.71" ],
    "DEASE LAKE A": [ "34.73", "19.47", "20.41", "13.21", "33.7", "49.95", "66.65", "59.28", "52.56", "34.1", "32.46", "28.8" ],
    "DRYAD POINT": [ "279.69", "210.54", "209.24", "203.32", "156.87", "143.32", "117.11", "145.41", "207.95", "333.52", "347.21", "274.53" ],
    "EGG ISLAND": [ "316.72", "218.21", "220.13", "196.55", "126", "121.51", "82.1", "110.42", "155.79", "326.85", "390.24", "319.45" ],
    "FALLS RIVER": [ "474.77", "341.33", "283.38", "271.02", "161.94", "120.07", "83.4", "139.73", "313", "509.38", "489.98", "448.09" ],
    "FRASER CAMP": [ "139.75", "108.95", "80.98", "29.87", "24.43", "35.68", "39.92", "61.29", "103.65", "113.61", "141.31", "165.4" ],
    "GRAHAM INLET": [ "48.55", "31.71", "16.83", "8.96", "16.75", "30.14", "32.31", "33", "48.55", "38.09", "29.26", "43.53" ],
    "GREEN ISLAND": [ "266.17", "174.3", "189.52", "165.55", "128.73", "105.33", "106.69", "166.1", "250.26", "353.93", "296.76", "270.94" ],
    "HARTLEY BAY": [ "518.36", "426.52", "327.14", "301.24", "227.78", "182.21", "159.36", "192.01", "405.23", "686.35", "693.88", "553.08" ],
    "HAZELTON TEMLEHAN": [ "69.01", "39.24", "23.46", "31.01", "41.35", "56.36", "47.08", "47.54", "62.11", "74.23", "71.73", "62.18" ],
    "ISKUT RANCH": [ "43.49", "21.08", "15.79", "6.31", "24.48", "43.37", "67.08", "58.03", "52.46", "34.87", "31.66", "40.94" ],
    "IVORY ISLAND": [ "297.64", "194.54", "229.46", "211.25", "146.95", "129.06", "118.12", "163.68", "215.21", "353.26", "383.73", "326.27" ],
    "KEMANO": [ "249.83", "170.61", "137.45", "100.29", "68.67", "62.53", "61.9", "76.85", "162.53", "317.72", "293.09", "285.43" ],
    "KILDALA": [ "261.37", "194.64", "144.63", "136.45", "85.47", "87.74", "80.95", "100.88", "184.59", "313.14", "296.45", "283.99" ],
    "KITIMAT": [ "318.41", "237.7", "157.61", "116.41", "76.41", "71.93", "46.5", "71.41", "186.26", "325.85", "335.86", "293.86" ],
    "KITIMAT 2": [ "390.56", "257.79", "216.79", "168.87", "104.19", "81.58", "61.33", "100.63", "210.87", "393.83", "407.12", "381.08" ],
    "KITIMAT 3": [ "320.58", "172.81", "172.3", "119.91", "87.91", "67.14", "70.91", "101.18", "187.64", "343.17", "347.47", "340.62" ],
    "KITIMAT HATCHERY": [ "307.34", "153.01", "188.95", "147.52", "86.02", "70.58", "70.43", "108.14", "166.58", "353.83", "323.09", "331.64" ],
    "KITIMAT TOWNSITE": [ "288.41", "186.78", "160.72", "128.34", "89.47", "73.14", "62.38", "95.74", "190.22", "323.45", "320.25", "291.8" ],
    "LANGARA": [ "205.84", "140.6", "149.78", "139.79", "109.31", "94.17", "93.45", "133.99", "190.5", "256.63", "229.97", "223.15" ],
    "MCINNES ISLAND": [ "303.75", "212.08", "226.94", "197.21", "138.6", "123.84", "109.45", "132.88", "213.1", "312.55", "342.14", "293.3" ],
    "MORESBY ISLAND MITCHELL INLET": [ "746.42", "579.13", "555.51", "447.43", "300.44", "234.69", "155.86", "286.68", "431.11", "789.23", "858.35", "939.97" ],
    "NASS CAMP": [ "137.44", "69.38", "50.12", "47.96", "49.97", "60.65", "58.58", "77.22", "116.81", "156.1", "137.04", "130.58" ],
    "PALLANT CREEK": [ "458.44", "309.34", "272.03", "254.49", "134.22", "103.06", "60.66", "107.48", "224.04", "474.14", "493.36", "444.66" ],
    "PINE ISLAND": [ "274.9", "168.13", "175.19", "137.96", "86.36", "91.79", "64.24", "90.05", "122.91", "292.86", "348.44", "303.28" ],
    "PLEASANT CAMP": [ "200.38", "139.1", "106.17", "69.66", "51.93", "37.44", "35.75", "72.4", "148.76", "188.05", "159.99", "217.27" ],
    "PORT ALICE": [ "492.21", "353.97", "320.37", "258.28", "147.34", "100.1", "59.52", "94.62", "130.23", "417.58", "561.43", "491.18" ],
    "PORT HARDY A": [ "247.01", "160.15", "159.7", "125.04", "79.29", "80.74", "53.67", "73.05", "109.62", "256.66", "311.72", "250.9" ],
    "PRINCE RUPERT": [ "276.28", "185.55", "199.64", "172.35", "137.58", "108.83", "118.68", "169.07", "266.26", "373.63", "317.01", "294.23" ],
    "PRINCE RUPERT MONT CIRC": [ "327.67", "220.9", "234.79", "211.23", "160.29", "126.83", "126.95", "176.81", "296.53", "431.71", "375.47", "370.62" ],
    "PRINCE RUPERT R PARK": [ "314.08", "238.09", "242.76", "216.17", "153.89", "131.8", "115.7", "155.52", "242.78", "406.36", "383.51", "342.51" ],
    "PRINCE RUPERT SHAWATLANS": [ "317.75", "238.26", "198.41", "197.79", "153.31", "132.78", "127.94", "174.41", "278.18", "441.08", "378.84", "387.93" ],
    "QUATSINO": [ "352.44", "234.19", "212.2", "177.13", "99.87", "84.94", "50.96", "82.28", "121.52", "313.35", "414.08", "349.66" ],
    "QUATSINO LIGHTSTATION": [ "345.45", "223.33", "238.8", "204.37", "132.44", "115.08", "74.27", "111.57", "143.95", "307.65", "367.25", "337.74" ],
    "ROSSWOOD": [ "121.92", "82.21", "45.19", "44.2", "49.86", "58.26", "57.1", "61.97", "111.44", "167.23", "149.68", "128.21" ],
    "SANDSPIT A": [ "190.73", "130.78", "116.84", "97.68", "66.44", "51.67", "48.13", "62.24", "83.47", "169.54", "193.8", "196.16" ],
    "SEWALL MASSET INLET": [ "168.4", "121.79", "118.75", "106.18", "85.66", "68.39", "61.81", "92.12", "121.51", "202.69", "207.76", "173.7" ],
    "SMITHERS A": [ "42.69", "23.35", "20.58", "23.75", "38.09", "55.18", "45.57", "43.83", "53.79", "64.83", "54.99", "41.89" ],
    "STEWART A": [ "238", "136.96", "121.78", "89.06", "72.27", "65.6", "73.02", "122.4", "217.33", "278", "230.13", "222.2" ],
    "SUSKWA VALLEY": [ "60.58", "36.33", "37.87", "40.55", "62.87", "75.58", "70.38", "60.51", "80.99", "89.87", "77.47", "64.07" ],
    "TAHTSA LAKE WEST": [ "267.32", "202.41", "134.56", "94.11", "75.11", "64.87", "51.44", "74.42", "155.17", "281.89", "295.14", "288.27" ],
    "TELEGRAPH CREEK": [ "44.63", "21.58", "9.52", "6.98", "19.97", "18.55", "32.74", "30.91", "41.81", "46.04", "33.55", "42.69" ],
    "TERRACE A": [ "173.47", "110.56", "92.25", "73.7", "56.38", "50.79", "52.77", "61.15", "111.48", "190.28", "187.08", "180.89" ],
    "TERRACE PCC": [ "135.38", "92.47", "71.28", "64.55", "50.98", "47.63", "47.69", "57.22", "104.9", "176.56", "158.37", "161.82" ],
    "TLELL": [ "146.14", "121.81", "95.61", "96.06", "64.44", "60.46", "55.83", "71.22", "92.61", "177.82", "174.53", "164.57" ],
    "TODAGIN RANCH": [ "34.82", "17.5", "15.38", "9.54", "26.24", "37.6", "60.8", "52.94", "61.51", "42.87", "38.71", "41.27" ],
    "TRIPLE ISLAND": [ "139.12", "104.14", "112.82", "96.43", "84.75", "69.41", "65.8", "105.49", "128.26", "168.31", "173.71", "164.82" ],
    "UNUK RIVER ESKAY CREEK": [ "250.28", "210.65", "168.55", "93.13", "92.67", "67.64", "82.08", "142.41", "223.94", "249.7", "214.71", "276.1" ]
  }

  canNormalsT = pd.DataFrame.from_dict(canadian_temp_normals, orient = 'index')
  canNormalsT.columns = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']
  canNormalsP = pd.DataFrame.from_dict(canadian_precip_normals, orient = 'index')
  canNormalsP.columns = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']


  # print(canNormalsT)


  can_prov = ["BC", "YT"]  # Canadian provinces British Columbia, Yukon T
  can_results = {}
  mn = str(int(month)) # format month for the url, does not work with leading zero for single digit months
  for prov in can_prov:
    can_url = "http://climate.weather.gc.ca/prods_servs/cdn_climate_summary_report_e.html?intYear="+year+"&intMonth="+mn+"&prov="+prov+"&dataFormat=csv&btnSubmit=Download+data"
    # print (can_url)
    # skip csv header and extract desired parameters . Tm = Mean Temp, D = mean temp dep from 1981-2010 normal, P = total precip, P%N percent of 1981-2010 normal precip
    can_results[prov] = pd.read_csv(can_url, skiprows=31)
    can_results[prov] = can_results[prov][['Stn_Name', 'Lat', 'Long', 'Tm', 'D', 'P', 'P%N']] 

    can_results[prov]['Tm'] = can_results[prov]['Tm']
    can_results[prov]['D'] = can_results[prov]['D']
    can_results[prov]['P'] = can_results[prov]['P']
 
 # shuffle stuff around
  can_df = can_results['BC'].append(can_results['YT'])
  can_df.columns = ['Stn', 'lat', 'lon', 'tmpAbs', 'temp1', 'pcpAbs', 'precip']
  can_df.index = can_df['Stn']
  can_df.drop(columns=['Stn'])

 # if monthly documents has no departure from normal, check if normals available from dicts above and replace corresponding nan values if so. 
 # temp
  df2 = can_df.join(canNormalsT[mn].astype(float))
  df2.columns = ['Stn', 'lat', 'lon', 'tmpAbs', 'temp', 'pcpAbs', 'precip', 'Tnorm']
  df2['temp1'] = df2['tmpAbs'] - df2['Tnorm']
  df2.temp.fillna(df2.temp1, inplace=True)
  df2.drop(columns=['temp1', 'Tnorm'], inplace = True)
# same for precip
  df2 = df2.join(canNormalsP[mn].astype(float))
  df2.columns = ['Stn', 'lat', 'lon', 'tmpAbs', 'temp', 'pcpAbs', 'precip', 'Pnorm']
  df2['pcp1'] = np.round(100 * df2['pcpAbs'] / df2['Pnorm'], decimals = 1)  
  df2.precip.fillna(df2.pcp1, inplace=True)
  df2.drop(columns=['pcp1', 'Pnorm'], inplace = True)

  # convert to freedom units
  df2['tmpAns'] =  df2['tmpAbs']* 9/5 + 32
  df2['temp'] =  df2['temp']* 9/5
  df2['pcpAbs'] =  df2['pcpAbs']*  0.039



  df2.to_csv(year + month +'CANdata.csv', sep=',')
  return df2

